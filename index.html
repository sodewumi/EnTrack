Skip to content
This repository  
Pull requests
Issues
Gist
 @leskat47
 Unwatch 4
  Star 0
  Fork 0
sodewumi/EnTrack
 branch: master  EnTrack/index.html
@amp5amp5 3 days ago Committing updated files to github.
1 contributor
RawBlameHistory     271 lines (247 sloc)  9.722 kB
<!DOCTYPE html>
<!--[if lt IE 7]>
<html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>
<html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>
<html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js"> <!--<![endif]-->
  <head>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="style.css">
    
   
    <!-- WhereBus script files -->
    <script type="text/javascript"
            src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA6U2ExB8yLDc7RiGPYK3C3yIzDPpyFJE0&sensor=false"></script>
    <script src="https://cdn.firebase.com/js/client/2.2.7/firebase.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/3.9.3/lodash.js"></script>
   

    <!-- Custom CSS and JV -->
    <script src="maps.js"></script>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="Firebase Open Data Sets examples - Transit">
    <meta name="viewport" id="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="all">



<!-- realtime data JS -->
    <script>
    $(document).ready(function () {
      
        // Generate a Firebase location
        var firebaseUrl = "https://enTrack.firebaseio.com/";
        var firebaseRef = new Firebase(firebaseUrl);

        // Set the URL of the link element to be the Firebase URL
        document.getElementById("firebaseRef").setAttribute("href", firebaseUrl);

        // Create a new GeoFire instance at the Firebase location
        var geoFire = new GeoFire(firebaseRef);

        /* Uses the HTML5 geolocation API to get the current user's location */
        var getLocation = function() {
          if (typeof navigator !== "undefined" && typeof navigator.geolocation !== "undefined") {
            log("Asking user to get their location");
            navigator.geolocation.getCurrentPosition(geolocationCallback, errorHandler);
          } else {
            log("Your browser does not support the HTML5 Geolocation API, so this map will not work.")
          }
        };

        /* Callback method from the geolocation API which receives the current user's location */
        var geolocationCallback = function(location) {
          var latitude = location.coords.latitude;
          var longitude = location.coords.longitude;
          log("Retrieved user's location: [" + latitude + ", " + longitude + "]");

          var username = document.getElementById("username").val();
          geoFire.set(username, [latitude, longitude]).then(function() {
            log("Current user " + username + "'s location has been added to GeoFire");

            // When the user disconnects from Firebase (e.g. closes the app, exits the browser),
            // remove their GeoFire entry
            firebaseRef.child(username).onDisconnect().remove();

            log("Added handler to remove user " + username + " from GeoFire when you leave this page.");
            log("You can use the link above to verify that " + username + " was removed from GeoFire after you close this page.");
          }).catch(function(error) {
            log("Error adding user " + username + "'s location to GeoFire");
          });
        }

        /* Handles any errors from trying to get the user's current location */
        var errorHandler = function(error) {
          if (error.code == 1) {
            log("Error: PERMISSION_DENIED: User denied access to their location");
          } else if (error.code === 2) {
            log("Error: POSITION_UNAVAILABLE: Network is down or positioning satellites cannot be reached");
          } else if (error.code === 3) {
            log("Error: TIMEOUT: Calculating the user's location too took long");
          } else {
            log("Unexpected error code")
          }
        };

        // Get the current user's location
        getLocation();

        /*************/
        /*  HELPERS  */
        /*************/
        /* Returns a random string of the inputted length */
        function generateRandomString(length) {
            var text = "";
            var validChars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";

            for(var i = 0; i < length; i++) {
                text += validChars.charAt(Math.floor(Math.random() * validChars.length));
            }

            return text;
        }

        /* Logs to the page instead of the console */
        function log(message) {
          var childDiv = document.createElement("div");
          var textNode = document.createTextNode(message);
          childDiv.appendChild(textNode);
          document.getElementById("log").appendChild(childDiv);
        }
      })();
      

      });
    </script>


  </head>
  <body >
        <div class="row" id="headline"></div>
        <div class="row">
          <div class="col-md-6">
            <div id="top">
             <img id="logo" src="logo.gif" height="90px">
          </div>
          </div>
          <div class="col-md-1">
          </div>
          <div class="col-md-4">
           <div id="log">
             <input id="username" class="form-control" placeholder="username" type="text">
             <button id="login" class="btn btn-default btn-sm" style="display: inline">Log in with GitHub</button>
             <button id="logout" class="btn btn-default btn-sm" style="display: inline">Log out</button>
           </div>
           <div class="col-md-1">
           </div>
          </div>
        </div>
  
  <hr>

          <div class="transit-opendata-example">
            <h2>Where are my friends?</h2>
            <div class="transit-map-canvas" data-example="transit" id="map-canvas"></div>
             <button id="tracker" class="form-control btn">Track Me</button> 
             
          </div>

          <!-- <p><button onclick="geoFindMe()">Show my location</button></p> -->
          <div id="out"></div>

          <!-- chat-buffer = geodata-store -->
          <div id="geodate-store">
          </div>

          <div id="chat">
            <h2 id="userHeading">
              Chat
            </h2>

            <ul id="chat-buffer">
            </ul>
            
            <hr>
            
            <hr>
            <p>
              <input id="message" placeholder="message" type="text">
            </p>
            <input type="submit" id="submit">
            <div id="out"></div>
           
          </div>
          <select id="system-selector" class="display: none"></select>



  </body>
</html>
